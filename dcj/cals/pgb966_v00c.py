'''This is a calibration file for data collected at PAPER in Green Bank
on JD 2454864.'''

import aipy as a, numpy as n,glob,capodb

class AntennaArray(a.fit.AntennaArray):
    def __init__(self, *args, **kwargs):
        self.rx_poly = [-155449126422333.19, 256293525638826.72, -189524803210046.41, 82771279346848.969, -23640471627039.688, 4613565363350.415, -622997603995.79053, 57475902027.739426, -3466894761.8145747, 123458994.13390201, -1970963.6385044381]
        self.ddc_poly = [65123029498.345612, -97672196551.106552, 64042861492.03476, -24111913057.711517, 5761340839.0835114, -912373536.43163371, 97137219.224425375, -6896379.6290631033, 314561.96293171198, -8363.013373925829, 98.57747247358202]
        self.sh_bp_poly = [1740933726689.9573, -2118223751372.7913, 1123959498161.6704, -339667273274.97797, 63936410104.877388, -7675053474.0383739, 573717104.7235471, -24412958.040951885, 452691.85122559778]
        #self.sh_bp_poly =    [1]
        self.bl_gain = {}
        a.fit.AntennaArray.__init__(self, *args, **kwargs)
        self._update_passband()
    def bl2str(self, bl):
        i,j = self.bl2ij(bl)
        return '%d_%d' % (i, j)
    def str2bl(self, s):
        i,j = map(int, s.split('_'))
        return self.ij2bl(i,j)
    def get_params(self, ant_prms={'*':'*','aa':'*'}):
        prms = a.fit.AntennaArray.get_params(self, ant_prms=ant_prms)
        if not ant_prms.has_key('aa'): return prms
        for p in ant_prms['aa']:
            if p.startswith('*'):
                for k in self.bl_gain: prms[self.bl2str(k)] = self.bl_gain[k]
            else:
                try: prms[p] = self.bl_gain[self.str2bl(p)]
                except(KeyError): pass
        return prms
    def set_params(self, prms):
        a.fit.AntennaArray.set_params(self, prms)
        for key in self.bl_gain:
            try: self.bl_gain[key] = prms[self.bl2str(key)]
            except(KeyError): pass
    def update(self):
        a.fit.AntennaArray.update(self)
        self._update_passband()
    def _update_passband(self):
        afreqs = self.ants[0].beam.afreqs
        self._passband = n.polyval(self.rx_poly, afreqs)
        self._passband *= n.polyval(self.ddc_poly, afreqs)
        bm_resp = self.ants[0].bm_response((0,0,1))
        self._beamgain = (bm_resp * n.conjugate(bm_resp)).squeeze()
        self._passband *= self._beamgain
        self._passband *= n.polyval(self.sh_bp_poly, afreqs).clip(.5,2)**2
        self._passband = n.clip(self._passband, 0, n.Inf)
    def passband(self, i, j):
        bl = self.ij2bl(i,j)
        g=16
        return a.fit.AntennaArray.passband(self, i, j) * self._passband * g
    def bm_response(self, i, j, pol='xx'):
        return a.fit.AntennaArray.bm_response(self,i,j,pol=pol)/self._beamgain

prms = {
    'loc': ('38:25:59.24',  '-79:51:02.1'), # Green Bank, WV
    'antpos_selfcal':[ [0.000000,0.000000,0.000000],
#[285.469430,493.657479,-349.815776], #a1 self cal
[267.310571,502.131217,-347.223805], #a1 GPS
#[499.454692,357.591747,-610.959884], #a2 self cal
[482.828585,370.498434,-609.635709], #a2 GPS
#[478.777650,-315.217746,-599.136889],#a3 self cal
[467.480466,-302.821612,-604.831070], #a3 GPS
#[29.846678,-181.208328,-41.126410], #a4 self cal
[17.585160,-177.697419,-44.929177], #a4 GPS
#[-0.249647,32.653343,0.923075], #a5 self cal
[-0.601652,32.831477,1.192852], #a5 GPS
#[7.672218,133.980308,-7.093299],#a6 self cal
[-7.546067,136.965573,-7.973434],#a6 GPS
#[111.866916,393.367221,-133.117721],#a7 self cal
[94.320478,398.597529,-131.380824], #a7 GPS
[208.883644,473.703620,-252.355236], #a8 self cal
#[190.948051,480.870937,-249.892555], #a8 GPS
[431.250021,438.606680,-526.325112], #a9 self cal
#[413.811902,450.043322,-524.260773], #a9 GPS
#[561.346236,200.978439,-692.576234], #a10 self cal
[545.933940,214.937725,-692.836178], #a10 GPS
[552.577941,-155.660744,-689.815440],
[393.985876,-396.291442,-500.143294],
[261.128334,-429.695544,-338.206817],
[182.622941,-401.850222,-238.219940],
[78.718403,-292.957416,-105.771503],
],
'antpos':[ [0.000000,0.000000,0.000000],
[267.310571,502.131217,-347.223805],
[482.828585,370.498434,-609.635709],
[467.480466,-302.821612,-604.831070],
[17.585160,-177.697419,-44.929177],
[-0.601652,32.831477,1.192852],
[-7.546067,136.965573,-7.973434],
[94.320478,398.597529,-131.380824],
[190.948051,480.870937,-249.892555],
[413.811902,450.043322,-524.260773],
[545.933940,214.937725,-692.836178],
[539.549174,-141.697956,-692.560346],
[383.139502,-385.462770,-506.519627],
[250.940491,-421.511433,-344.495876],
[171.810477,-395.292783,-244.074156],
[67.164126,-288.486871,-110.681382],
],
    'delays': [
         0    , -2.58518702698, -1.89729494662, -1.18796673013,
        2.42019774823,-1.41880651764,1.74296572113, 0.00000000000,
        -0.625453606583,-0.226584377207,-2.42439114356,0.666491487533,
        -3.00672496112,0.838178371755,0.794018726043,0.70073902972,
    ],
#     0
#   off -0.0205217202386
# 1
#   off -0.0152889785731
# 10
#   off -0.0423431840867
# 11
#   off -0.0405651725616
# 12
#   off -0.0269430660945
# 13
#   off -0.0256911552542
# 14
#   off -0.0618954891664
# 15
#   off -0.0340046644193
# 2
#   off 0.102384109473
# 3
#   off 0.0981725922235
# 4
#   off -0.00919377344286
# 5
#   off -0.0181664070181
# 6
#   off -0.029307356485
# 7
#   off 0.213823841248
# 8
#   off -0.0515565937587
# 9
#   off -0.0448767953406
    'offsets': {
        0:0,1:0,2:0,3:0,
        4:0, 5:0,6:0,7:0,
        8:0,9:0,10:0,
        11:0,12:0,13:0,
        14:0,15:0
    },
    'amps': [
        0.00099746, 0.00096208, 0.00100036, 0.00091688,
        0.00101654, 0.00104024, 0.00094389, 0.00100000,
        0.00089092, 0.00095099, 0.00104108, 0.00091560,
        0.00088762, 0.00095644, 0.00099840, 0.00110732,
    ],
    'bp_r': n.array([
        [.8871]] * 16),
    'bp_i': n.array([[0., 0., 0.]] * 16),
    'beam': a.fit.BeamAlm,
    'bm_prms': {
        'alm7': n.array(
[2339541860.3877764, 0.0, 0.0, 0.0, 2545457.8378195195, -59449.478882704789, 1609373981.0957661, 0.0, 0.0, 0.0, -828223697.40936637, 89810.572886365975, 0.0, 0.0, 1788772.4000249961, -151958.40758936064, 0.0, 0.0, -745333.82145773072, 146795.20859468862, 108906575.55491312, 0.0, 0.0, 0.0, 734012116.72192395, -4812.8712141006181, 0.0, 0.0, 26637691.073258791, 60404.303093680697, 0.0, 0.0, -777810.735068187, -65646.374226273198, 0.0, 0.0, 1230081.2194052094, -151045.46862115563, 0.0, 0.0, -301317.86943164741, -324859.21246992587, -1256620557.3016577, 0.0, 0.0, 0.0, 1100496215.824836, -12616.868848869693, 0.0, 0.0, -293265657.2817421, -61694.443628355337, 0.0, 0.0, -1133057770.72279, 98270.769977267773, 0.0, 0.0, 556601.56628149329, -79468.847465967337, 0.0, 0.0, 293855.95845700562, -51276.87792154093, 0.0, 0.0, 923517.39990226086, -247280.84453796415, 0.0, 0.0, 686723.13454959099, -231385.13865161, -1053510521.9838445, 0.0, 0.0, 0.0, 622022547.13787043, 8093.032595234562, 0.0, 0.0, 146261729.14702246, 48289.222311742837, 0.0, 0.0, -303028037.43643337, -109644.2017449291, 0.0, 0.0, 77092837.328466982, -49713.458392400309, 0.0, 0.0, 61778.269260810528, -3868.904620976994, 0.0, 0.0, -415744.19864848693, 135262.93943485423, 0.0, 0.0, -145479.26517530635, 54203.480932852741, 0.0, 0.0, 412347.62554241106, -57637.096230127361, 0.0, 0.0, -69743.234032958309, 95251.392603252651, 73044749.975840643, 0.0, 0.0, 0.0, -29955971.21398598, 59219.278996693654, 0.0, 0.0, 150750566.78420827, -7146.6673046954893, 0.0, 0.0, -120119746.83396851, 115812.80100884248, 0.0, 0.0, -462552688.23787498, 57762.374414345431, 0.0, 0.0, -96108995.29849048, 110437.30605050205, 0.0, 0.0, 859373.01119077392, -11051.858857269812, 0.0, 0.0, -361717.66350617347, -34994.87873958666, 0.0, 0.0, 192811.40809464757, -80273.324989213404, 0.0, 0.0, -110851.72363224049, 23522.49915131144, 0.0, 0.0, 138872.51922103288, -39949.853109648539, 0.0, 0.0, -55274.662501543098, -71546.008145667467, 419640619.06833905, 0.0, 0.0, 0.0, -337704553.97812158, -60577.847761724384, 0.0, 0.0, 206287882.51185822, 17200.099498047741, 0.0, 0.0, -399623522.94382, 13948.386870399307, 0.0, 0.0, -142008510.75204512, -21820.19947088624, 0.0, 0.0, 254486920.11873037, -30767.272522290386, 0.0, 0.0, -195604433.98726806, -8763.3871362593272, 0.0, 0.0, 499637.34623089049, -19237.267087631091, 0.0, 0.0, -573636.25990263943, 66708.85403274573, 0.0, 0.0, 100514.90180643577, 35614.972887139607, 0.0, 0.0, -66021.303397675787, -20078.405229485063, 0.0, 0.0, -104113.25169145738, 35644.726535472677, 0.0, 0.0, -119376.26954082829, -22838.51441548307, 0.0, 0.0, -237367.13888926245, -19417.390262012759, -29116250.795294326, 0.0, 0.0, 0.0, 40819399.444596499, 38373.008619095956, 0.0, 0.0, -31119972.491947223, -12930.075776603833, 0.0, 0.0, 83235154.103836656, 46069.377976053205, 0.0, 0.0, 248073427.3377988, 38291.692963856818, 0.0, 0.0, 271111041.12556297, 150189.25061985239, 0.0, 0.0, 18375070.017510861, -33274.699007258096, 0.0, 0.0, 44568328.339125231, -52835.19473543921, 0.0, 0.0, -388753.4447232802, 39084.535931790531, 0.0, 0.0, 510277.92208311119, -76510.594959691531, 0.0, 0.0, -502241.56347829878, 44375.892928161891, 0.0, 0.0, 181785.33063208507, 7566.1127692377167, 0.0, 0.0, -57627.222452425885, 17434.85086727516, 0.0, 0.0, -209582.86742085061, 28382.552582626875, 0.0, 0.0, 82166.146833013845, -3950.7817786206215, 0.0, 0.0, 66003.465730993034, 9439.5668385137578, -587322101.68005741, 0.0, 0.0, 0.0, 333148345.57188034, -9370.3528806114518, 0.0, 0.0, 98431708.589627966, 3333.739057924794, 0.0, 0.0, 280674084.89771318, -98507.505370538231, 0.0, 0.0, -222414784.08487847, -42085.846270791983, 0.0, 0.0, -52054134.401742868, -12610.784253727305, 0.0, 0.0, 202588189.76769817, -2994.6815060214744, 0.0, 0.0, 77109949.686795011, 11652.671333508104, 0.0, 0.0, -104585179.10977513, 75204.986311900502, 0.0, 0.0, -165953.07650031563, -29150.252017042309, 0.0, 0.0, 155872.759230225, 25064.748074140847, 0.0, 0.0, -206717.00436203933, -16399.938201079007, 0.0, 0.0, 292289.46324828872, 36287.912339031507, 0.0, 0.0, -141278.05491341592, -63656.508644435184, 0.0, 0.0, -61173.758340973785, 22085.581085967257, 0.0, 0.0, 194589.54342779948, -57070.986213237928, 0.0, 0.0, 134696.29087697165, 13969.166912426772, 0.0, 0.0, -31022.849301397477, -1076.3473936189134, 103040792.50053096, 0.0, 0.0, 0.0, 27850309.25357287, -28086.91396120534, 0.0, 0.0, 134022819.27368543, 21947.116871102073, 0.0, 0.0, 262351742.8467541, 88592.39135963851, 0.0, 0.0, -322672782.11381936, -7211.1895965347667, 0.0, 0.0, 216420491.55842, 116561.84201099619, 0.0, 0.0, 320179801.61659813, 37331.149058827301, 0.0, 0.0, 276445524.95744705, -94661.20216878684, 0.0, 0.0, 112973584.19064553, -41078.329283443658, 0.0, 0.0, -57782726.611569807, -101309.08274440971, 0.0, 0.0, 453878.61139013176, -13606.850772858654, 0.0, 0.0, -571524.36684827553, 102574.10164339219, 0.0, 0.0, 323130.99705462425, -19729.401121951316, 0.0, 0.0, -170346.79950011807, 69670.907834790123, 0.0, 0.0, 31003.815375734746, -37158.289292948844, 0.0, 0.0, 146225.71169309004, 42580.43084245819, 0.0, 0.0, 64423.556421167683, 42664.594013009788, 0.0, 0.0, 245810.19171951851, 11276.421248019567, 0.0, 0.0, -84076.258499156975, 6367.9614766103459, 0.0, 0.0, -32480.779351554389, -5571.2041601016363, 517207688.72884464, 0.0, 0.0, 0.0, -323149501.932742, -30879.366437457255, 0.0, 0.0, 55436092.263042197, -8909.6450726970234, 0.0, 0.0, 62815396.221041612, -100363.78317597842, 0.0, 0.0, 75673219.696532935, -49591.629906166178, 0.0, 0.0, 152040006.26282948, 41313.962710342101, 0.0, 0.0, 152308916.43423107, 25618.593129857149, 0.0, 0.0, 186891901.42852405, 165494.11439696033, 0.0, 0.0, 288346779.98596185, 49945.042194289155, 0.0, 0.0, -39797593.899166696, 96233.343578619548, 0.0, 0.0, 23895542.213446811, -13431.799661361611]
        ),
        'alm6': n.array(
[-1682840655.7397566, 0.0, 0.0, 0.0, -1711591.7076598166, 43268.220870083955, -1143919666.5478625, 0.0, 0.0, 0.0, 593517292.42664909, -65283.157507573436, 0.0, 0.0, -1246950.7495486641, 102913.51244749276, 0.0, 0.0, 537585.40571218694, -104579.74760386803, -89023589.650391042, 0.0, 0.0, 0.0, -515801620.28757012, 3835.1219216188265, 0.0, 0.0, -9519085.096616555, -42058.600253379904, 0.0, 0.0, 549374.44852366997, 43906.290582433583, 0.0, 0.0, -855834.39874033467, 108126.24926145445, 0.0, 0.0, 222195.16771370641, 237642.57855867391, 900212434.92554474, 0.0, 0.0, 0.0, -783847017.2771672, 8827.3059096889847, 0.0, 0.0, 203097289.1893343, 44323.757774432714, 0.0, 0.0, 825899014.59630418, -70361.947053980373, 0.0, 0.0, -385797.57398312376, 56488.553072584233, 0.0, 0.0, -206713.79242425755, 36604.723409029815, 0.0, 0.0, -648378.60504989512, 177090.62994044283, 0.0, 0.0, -491500.04846577958, 165258.26815354521, 748492609.72981846, 0.0, 0.0, 0.0, -447037053.97125101, -5914.6397203078832, 0.0, 0.0, -110513693.85019055, -35126.241273298649, 0.0, 0.0, 220274088.08394623, 79580.139845153171, 0.0, 0.0, -56026594.829514518, 35755.399410749036, 0.0, 0.0, -44938.169397685851, 2220.2762057788041, 0.0, 0.0, 287848.45793695195, -95441.946344219934, 0.0, 0.0, 101743.44315853725, -40541.202255965494, 0.0, 0.0, -285054.59700798144, 41303.359825242238, 0.0, 0.0, 46244.710054051211, -67212.711335125292, -44041107.329766646, 0.0, 0.0, 0.0, 15107822.343750557, -43598.915227262929, 0.0, 0.0, -101860259.20795351, 5353.5723285824379, 0.0, 0.0, 84553880.335841835, -83341.788137443247, 0.0, 0.0, 337613615.13955611, -41903.446599686984, 0.0, 0.0, 72412775.734071612, -80059.279634474457, 0.0, 0.0, -588237.21592715825, 9194.6628262301656, 0.0, 0.0, 243212.27394838491, 25641.307203555763, 0.0, 0.0, -133662.52609966675, 57954.553146156089, 0.0, 0.0, 73882.886321533122, -16564.780985554829, 0.0, 0.0, -101186.04118410732, 28335.302871587653, 0.0, 0.0, 35513.73382738611, 52536.886659263204, -293303500.27532697, 0.0, 0.0, 0.0, 237891731.49595258, 44199.505120788715, 0.0, 0.0, -147256626.10311833, -12437.9505095732, 0.0, 0.0, 285361197.48927307, -10560.135296753089, 0.0, 0.0, 103558381.73224089, 15444.075251361448, 0.0, 0.0, -178293124.71661079, 22511.40472838908, 0.0, 0.0, 140017768.26605824, 6629.3114978380881, 0.0, 0.0, -345562.76069057622, 13497.37959582131, 0.0, 0.0, 397136.46207118401, -48518.115316762902, 0.0, 0.0, -68893.066808687741, -25930.153367522988, 0.0, 0.0, 45816.738821449399, 14355.782564569517, 0.0, 0.0, 71981.049661257435, -26082.090003941765, 0.0, 0.0, 81526.323039909912, 16211.735311134084, 0.0, 0.0, 169788.00779515717, 13810.930876470527, 12014180.412079982, 0.0, 0.0, 0.0, -23880175.424912311, -28429.390457322876, 0.0, 0.0, 22554811.333487321, 9609.289650095292, 0.0, 0.0, -60410573.32658378, -33040.804712100871, 0.0, 0.0, -178854607.3069993, -28255.269135428531, 0.0, 0.0, -191830763.17047393, -109041.20940787076, 0.0, 0.0, -14530909.754064962, 23787.506021597805, 0.0, 0.0, -32230962.77082983, 39520.716686591921, 0.0, 0.0, 267715.89709517505, -28107.733278785105, 0.0, 0.0, -354012.93803026469, 54513.498722923818, 0.0, 0.0, 347534.24552620621, -31323.261421804727, 0.0, 0.0, -125487.86720105134, -4486.9964463644556, 0.0, 0.0, 39090.335531854325, -13052.853007882366, 0.0, 0.0, 143673.46426502339, -20135.230261674955, 0.0, 0.0, -56543.439648302083, 3122.4475940924008, 0.0, 0.0, -45868.804048797341, -6126.8356370013134, 418774562.73743814, 0.0, 0.0, 0.0, -237737805.09682667, 6752.375989328516, 0.0, 0.0, -72075142.745972261, -2747.4961354506149, 0.0, 0.0, -201993763.38517544, 70823.205383374414, 0.0, 0.0, 158768815.05921438, 30319.336318482547, 0.0, 0.0, 35482864.13295494, 10021.376505791888, 0.0, 0.0, -146714212.26659322, 2282.7061967656382, 0.0, 0.0, -56528721.132348061, -8853.6912030379099, 0.0, 0.0, 75839083.089084715, -54201.032520482106, 0.0, 0.0, 115179.55384436675, 20860.783343877702, 0.0, 0.0, -105770.00690166428, -18290.217941776365, 0.0, 0.0, 139053.31125694871, 11714.756418885541, 0.0, 0.0, -195903.24074493904, -25336.681641412528, 0.0, 0.0, 93868.420117579255, 44911.342317027469, 0.0, 0.0, 45076.44218795334, -15249.378403548457, 0.0, 0.0, -135033.80593733655, 40801.445314096723, 0.0, 0.0, -91653.363804972032, -10312.933082933174, 0.0, 0.0, 23759.68209124195, 1097.0976747571044, -66932016.065189764, 0.0, 0.0, 0.0, -23788168.823140278, 20122.731158883518, 0.0, 0.0, -95212071.702738538, -15534.221109059949, 0.0, 0.0, -188073149.99967983, -64137.507881617457, 0.0, 0.0, 231966764.50069213, 5290.7535950742167, 0.0, 0.0, -157750952.40394974, -84566.798200585501, 0.0, 0.0, -230594464.82390851, -28039.576826097924, 0.0, 0.0, -201897385.65255997, 69538.10721141228, 0.0, 0.0, -82108146.611323923, 29713.140414097023, 0.0, 0.0, 41486094.849228546, 72414.312907568747, 0.0, 0.0, -310718.81944169063, 10377.169060759375, 0.0, 0.0, 390351.35228845442, -73847.21406786752, 0.0, 0.0, -222772.87376209171, 14318.162490864002, 0.0, 0.0, 117959.41950427454, -49247.753218737002, 0.0, 0.0, -21498.498317434085, 25021.201041819313, 0.0, 0.0, -102682.75691731251, -29606.279617243668, 0.0, 0.0, -41142.193571923708, -30339.970817238231, 0.0, 0.0, -169502.26622833638, -8389.6935971581752, 0.0, 0.0, 58563.32314922486, -4313.7409006348344, 0.0, 0.0, 23249.802328263377, 4212.6148139868183, -371883602.06974387, 0.0, 0.0, 0.0, 232175281.26628038, 22620.335221496702, 0.0, 0.0, -38671055.708561167, 6131.9586688845675, 0.0, 0.0, -43528603.450865246, 72526.472667380353, 0.0, 0.0, -55062727.86279951, 36208.866534158915, 0.0, 0.0, -107817913.58242209, -29815.821755494122, 0.0, 0.0, -109909627.11466239, -18833.167218192852, 0.0, 0.0, -135262925.94851863, -120071.09028522605, 0.0, 0.0, -208788470.87089133, -36389.154724114582, 0.0, 0.0, 28652168.348697107, -69032.270676449407, 0.0, 0.0, -17274209.452643834, 9734.0538430373654]
        ),
        'alm5': n.array(
[403706800.28221178, 0.0, 0.0, 0.0, 377921.95053258317, -10626.547945052787, 270682342.46778214, 0.0, 0.0, 0.0, -141859334.42313012, 15887.44821274443, 0.0, 0.0, 288539.52311076008, -22906.34835394776, 0.0, 0.0, -129528.16152254723, 24820.644742261582, 24814677.409687489, 0.0, 0.0, 0.0, 120284556.32748196, -1036.3308389894357, 0.0, 0.0, -605729.20873776148, 9690.9524008622648, 0.0, 0.0, -129127.87169502767, -9652.3017699676366, 0.0, 0.0, 197531.61312072884, -25837.246656067458, 0.0, 0.0, -54710.175683457499, -58284.882489442978, -215159922.95133966, 0.0, 0.0, 0.0, 186019215.99766764, -2044.3488553934328, 0.0, 0.0, -46463326.216987282, -10639.261735484792, 0.0, 0.0, -201586960.69056138, 16809.549098594503, 0.0, 0.0, 88566.177444520392, -13383.843259159576, 0.0, 0.0, 48317.813144124026, -8681.1942155566812, 0.0, 0.0, 151275.62195206602, -42327.894404677892, 0.0, 0.0, 117219.81610079274, -39351.471524144887, -177100038.6442146, 0.0, 0.0, 0.0, 107259715.75756121, 1453.1030899624498, 0.0, 0.0, 28067416.044940639, 8557.5302641688995, 0.0, 0.0, -53586870.46182508, -19329.718873337515, 0.0, 0.0, 13630812.288061274, -8593.9661488467791, 0.0, 0.0, 10945.80830740216, -351.95473878597682, 0.0, 0.0, -66027.350737156376, 22410.411623124302, 0.0, 0.0, -23629.178345607779, 10176.858514433074, 0.0, 0.0, 65244.887718922582, -9872.8477384235557, 0.0, 0.0, -10033.871180551783, 15760.472658080285, 8028742.1383459521, 0.0, 0.0, 0.0, -1749046.4332288953, 10769.186346719207, 0.0, 0.0, 22543613.137546021, -1347.8614331596646, 0.0, 0.0, -19745627.793694295, 20021.922999150716, 0.0, 0.0, -82598523.941634133, 10169.830522648055, 0.0, 0.0, -18370078.500351604, 19413.131878238302, 0.0, 0.0, 132970.59503883988, -2567.1907851223805, 0.0, 0.0, -53721.321890950603, -6285.0561965797478, 0.0, 0.0, 30719.664978524925, -14005.408114895474, 0.0, 0.0, -16108.536790681606, 3879.5017957914301, 0.0, 0.0, 24657.505413370203, -6693.2415084409995, 0.0, 0.0, -7404.5959448614876, -12939.727613742602, 68001643.966613948, 0.0, 0.0, 0.0, -55683166.273619682, -10793.360670312564, 0.0, 0.0, 35088526.238039315, 3020.9462872848189, 0.0, 0.0, -67913390.984640375, 2681.9140394980145, 0.0, 0.0, -25316886.311175749, -3645.0437684210756, 0.0, 0.0, 41456542.065709226, -5525.9420432336929, 0.0, 0.0, -33436531.187180106, -1688.0415185329189, 0.0, 0.0, 79178.575936853114, -3140.2499771809889, 0.0, 0.0, -91084.760465681189, 11803.179546729871, 0.0, 0.0, 15592.873656204329, 6314.6627240970865, 0.0, 0.0, -10554.852109640051, -3404.8281084199557, 0.0, 0.0, -16480.214269180546, 6396.3795244227167, 0.0, 0.0, -18367.540542105169, -3825.3751404685863, 0.0, 0.0, -40530.636688871018, -3268.3858389559523, -227873.98270777095, 0.0, 0.0, 0.0, 4081610.0353950667, 7076.3339101534048, 0.0, 0.0, -5468532.2448272528, -2396.0451196052886, 0.0, 0.0, 14635055.135816641, 7907.1874544712855, 0.0, 0.0, 43107724.723974258, 7000.6072533289816, 0.0, 0.0, 45168560.585306443, 26484.884347589541, 0.0, 0.0, 3883205.5795408688, -5670.582312687683, 0.0, 0.0, 7797783.0791242691, -9936.7065507206553, 0.0, 0.0, -61012.67392942647, 6744.0977822795085, 0.0, 0.0, 81425.161463523036, -12962.512475743193, 0.0, 0.0, -79668.937908431471, 7356.2598696180721, 0.0, 0.0, 28707.402760077915, 809.52735193557533, 0.0, 0.0, -8746.9913948636877, 3274.865210235092, 0.0, 0.0, -32527.496437188005, 4760.9464991922114, 0.0, 0.0, 12864.535196064204, -832.00029795784747, 0.0, 0.0, 10556.018901839565, 1272.9743433307146, -99560971.928496942, 0.0, 0.0, 0.0, 56571708.172756575, -1615.5859403861625, 0.0, 0.0, 17704496.749613244, 763.49080409256544, 0.0, 0.0, 48534716.742137045, -17003.018752585314, 0.0, 0.0, -37763194.382560521, -7294.1391543359641, 0.0, 0.0, -7961538.1290563941, -2691.0853489959536, 0.0, 0.0, 35570570.205227591, -589.03195232087705, 0.0, 0.0, 13902662.350402825, 2267.5591605506288, 0.0, 0.0, -18402217.685603868, 13055.177220466281, 0.0, 0.0, -26499.599542035096, -4986.135949279299, 0.0, 0.0, 23645.509198888838, 4473.8110041939581, 0.0, 0.0, -30719.237975358614, -2789.8511530677047, 0.0, 0.0, 43070.163820745103, 5883.1433291601061, 0.0, 0.0, -20399.842810796781, -10550.68777740979, 0.0, 0.0, -11144.206731450669, 3487.7493760589073, 0.0, 0.0, 31059.975616858588, -9727.1216053126391, 0.0, 0.0, 20554.659218320696, 2557.3367252336948, 0.0, 0.0, -6141.6740341130599, -356.82917205418153, 13943615.897167765, 0.0, 0.0, 0.0, 6846628.9103968246, -4802.7258966541604, 0.0, 0.0, 22521343.429862302, 3659.0897601793304, 0.0, 0.0, 45020631.605965912, 15524.19516494358, 0.0, 0.0, -55718724.465187833, -1283.4688858620168, 0.0, 0.0, 38527659.047398612, 20515.367026348209, 0.0, 0.0, 55509331.390165575, 7084.148354710399, 0.0, 0.0, 49412596.016608573, -17132.778017687149, 0.0, 0.0, 19970546.205959212, -7191.6976528618834, 0.0, 0.0, -9943781.0739203971, -17263.930876918166, 0.0, 0.0, 70267.782143748351, -2660.6965222488011, 0.0, 0.0, -87995.943955047711, 17764.418809974944, 0.0, 0.0, 50820.116017446468, -3477.3808486299208, 0.0, 0.0, -27065.062727314697, 11595.557463691037, 0.0, 0.0, 4938.127167473308, -5546.4252326845917, 0.0, 0.0, 23966.191427392328, 6834.0970951226036, 0.0, 0.0, 8448.493474250603, 7183.4792265153392, 0.0, 0.0, 38680.444292841305, 2092.4588476990007, 0.0, 0.0, -13531.115345994896, 954.51754147397014, 0.0, 0.0, -5556.6565722777414, -1074.5978197244362, 89318066.575861022, 0.0, 0.0, 0.0, -55710310.02113492, -5549.3981433639065, 0.0, 0.0, 8916096.297976343, -1387.3958895647479, 0.0, 0.0, 9982530.1048742794, -17523.324422990579, 0.0, 0.0, 13397034.549360944, -8845.5018656390839, 0.0, 0.0, 25478056.68874168, 7183.2514138140696, 0.0, 0.0, 26500340.707330208, 4640.3152516313457, 0.0, 0.0, 32736910.58030254, 29147.956677048849, 0.0, 0.0, 50566999.542814262, 8878.0253945985005, 0.0, 0.0, -6895080.1103108786, 16528.473459999459, 0.0, 0.0, 4177206.6614720547, -2361.0074583158548]
        ),
        'alm4': n.array(
[-12477347.738796022, 0.0, 0.0, 0.0, -7068.0777553718981, 378.49413498499342, -7842149.1232915865, 0.0, 0.0, 0.0, 4327148.2398927528, -529.25719153644286, 0.0, 0.0, -7468.4466633004949, 450.14800117089038, 0.0, 0.0, 4110.3634069336695, -730.48167517630679, -1339231.6351491441, 0.0, 0.0, 0.0, -3212636.7921118061, 50.683779835548727, 0.0, 0.0, 466098.23222384427, -240.52104578383737, 0.0, 0.0, 3633.0248064736975, 178.15071472932365, 0.0, 0.0, -5033.7573945177601, 790.80865011029118, 0.0, 0.0, 1880.4759585371953, 2011.6719031376858, 6571464.0379476184, 0.0, 0.0, 0.0, -5482016.3672600565, 51.989425600214894, 0.0, 0.0, 1100287.7280482466, 333.18138292153725, 0.0, 0.0, 6795070.5778886126, -512.95702252567128, 0.0, 0.0, -2177.0308270420351, 392.70825552657044, 0.0, 0.0, -1315.2940524362973, 251.23009801279477, 0.0, 0.0, -4089.3115464294974, 1295.7349530883776, 0.0, 0.0, -3525.5016289580112, 1179.8474747746875, 5141176.2289515464, 0.0, 0.0, 0.0, -3338226.4807137521, -51.174309678033175, 0.0, 0.0, -1104202.3518877118, -286.80370866659001, 0.0, 0.0, 1779713.040378989, 638.12651450126475, 0.0, 0.0, -453805.64335788193, 270.84393642156408, 0.0, 0.0, -366.16876956621309, -18.350718070886963, 0.0, 0.0, 1620.2943294424897, -627.34480007640798, 0.0, 0.0, 622.66902954732666, -382.82951697467513, 0.0, 0.0, -1578.1814916357564, 301.34488885635329, 0.0, 0.0, 162.77873063588535, -434.73160346897544, 142886.90722226235, 0.0, 0.0, 0.0, -228879.05803353409, -382.15652032712819, 0.0, 0.0, -415595.85578326555, 51.518953523404853, 0.0, 0.0, 529512.69021869276, -626.07023673308356, 0.0, 0.0, 2822956.3516714349, -334.15833444216514, 0.0, 0.0, 724608.31408167002, -635.22830823436448, 0.0, 0.0, -2968.405187594788, 133.63971631191723, 0.0, 0.0, 1011.2971697613528, 214.05854673588044, 0.0, 0.0, -764.27002668356909, 453.92314047149631, 0.0, 0.0, 267.9124315973587, -106.78648151700992, 0.0, 0.0, -821.11184091336679, 192.92907828840981, 0.0, 0.0, 79.385843539252818, 454.32366677686559, -1765885.8188206295, 0.0, 0.0, 0.0, 1524297.6401974475, 363.35493430853438, 0.0, 0.0, -1062222.7751324882, -101.76923148926956, 0.0, 0.0, 2027719.8043904437, -104.5016037798506, 0.0, 0.0, 863614.70650223363, 105.76012652736306, 0.0, 0.0, -1094523.4140753672, 192.01933930751673, 0.0, 0.0, 1017470.5230597202, 67.320313353671438, 0.0, 0.0, -1933.1584170492499, 82.619376080885388, 0.0, 0.0, 2233.486123231829, -391.107923782103, 0.0, 0.0, -350.22715486407395, -209.92080925667938, 0.0, 0.0, 267.90991526560447, 97.700423450219191, 0.0, 0.0, 399.68716637935529, -220.52039052983511, 0.0, 0.0, 399.58187762426172, 108.55539579966837, 0.0, 0.0, 1234.3695038150188, 94.427078165819566, -401108.88947677176, 0.0, 0.0, 0.0, 129791.51489673424, -259.54509358243547, 0.0, 0.0, 178913.3566175552, 87.865296572779087, 0.0, 0.0, -471823.56352605432, -243.09525928968421, 0.0, 0.0, -1375385.9763471331, -252.10774281673244, 0.0, 0.0, -1279780.0725781627, -872.75010736324566, 0.0, 0.0, -182005.21074356628, 170.91808954967362, 0.0, 0.0, -253405.48199075932, 377.85668388886091, 0.0, 0.0, 1440.9420822530894, -209.30687968729893, 0.0, 0.0, -2033.7914229168516, 388.6474517539578, 0.0, 0.0, 1949.2955980979821, -205.86009601236648, 0.0, 0.0, -697.36951721756111, 13.684510355033249, 0.0, 0.0, 183.77378155246953, -122.25514009352614, 0.0, 0.0, 731.63568829063627, -138.46349348676449, 0.0, 0.0, -299.1109166903214, 38.487064464425551, 0.0, 0.0, -261.93374532606362, -9.1975507210356184, 2968544.9153852174, 0.0, 0.0, 0.0, -1693652.3668712648, 48.139226183935421, 0.0, 0.0, -616473.41397690598, -39.738526304679517, 0.0, 0.0, -1519333.6179027723, 530.99621305395283, 0.0, 0.0, 1123022.9681753214, 229.77844982055447, 0.0, 0.0, 166318.48351351987, 127.68247631492859, 0.0, 0.0, -1169178.2940629332, 25.001586629648532, 0.0, 0.0, -486265.17366265546, -92.686013060668643, 0.0, 0.0, 605002.85226377216, -414.86342408457159, 0.0, 0.0, 662.15024634428698, 153.17314886137234, 0.0, 0.0, -488.52515623877531, -152.77821190066558, 0.0, 0.0, 577.12092386756353, 83.664917223401716, 0.0, 0.0, -776.9769884577338, -156.34776181264951, 0.0, 0.0, 331.77693563540487, 297.0739675367326, 0.0, 0.0, 396.831593428519, -84.224810341374976, 0.0, 0.0, -774.63465383514233, 293.62050552341259, 0.0, 0.0, -433.25839418268595, -92.521655059693359, 0.0, 0.0, 259.6022072904583, 25.03331721193431, -109419.32509955806, 0.0, 0.0, 0.0, -390443.85032320191, 144.58054864868737, 0.0, 0.0, -652168.14010210475, -103.94759092575735, 0.0, 0.0, -1390623.4500866765, -503.30072833354313, 0.0, 0.0, 1749942.0215815213, 39.504154161090753, 0.0, 0.0, -1305984.1771202581, -671.34618599911028, 0.0, 0.0, -1761316.020767075, -274.54848613605259, 0.0, 0.0, -1689000.1600342444, 601.75453657121909, 0.0, 0.0, -662765.34164612473, 234.31644120459359, 0.0, 0.0, 308271.99217735988, 521.41338329793359, 0.0, 0.0, -1575.8293026469416, 108.19391637799269, 0.0, 0.0, 1928.2113681615624, -560.9243498951214, 0.0, 0.0, -1204.5106841240215, 114.78159128446833, 0.0, 0.0, 665.66310537155005, -330.33459064291714, 0.0, 0.0, -121.83383807315877, 108.18315562682398, 0.0, 0.0, -649.46522554913622, -174.7176272521867, 0.0, 0.0, -60.392525302814512, -208.74113697288536, 0.0, 0.0, -918.95496909157907, -76.738632196149013, 0.0, 0.0, 346.05341558317241, -17.184616115737619, 0.0, 0.0, 170.44991624408129, 43.524029361379164, -2799576.5630921065, 0.0, 0.0, 0.0, 1737989.4990900517, 190.57683311834327, 0.0, 0.0, -219724.49683133524, 29.771283287134313, 0.0, 0.0, -242732.75625129641, 564.60791681060289, 0.0, 0.0, -443161.91427416966, 297.87298272077334, 0.0, 0.0, -738872.71831551299, -227.10038998530987, 0.0, 0.0, -844101.46819167607, -162.37856885188461, 0.0, 0.0, -1062633.9580562364, -959.44574746405362, 0.0, 0.0, -1647477.5976454925, -298.8411493496472, 0.0, 0.0, 218645.34870213675, -509.6053849868087, 0.0, 0.0, -135391.56210188873, 77.625765975235623]
        ),
        'alm3': n.array(
[-11203585.257690791, 0.0, 0.0, 0.0, -10409.815334342326, 295.31306328217698, -7502739.4195181467, 0.0, 0.0, 0.0, 3934990.0951017113, -441.30284204673529, 0.0, 0.0, -7980.8660820847108, 631.66797926175286, 0.0, 0.0, 3595.2222888744514, -688.17870467736384, -695043.60307935125, 0.0, 0.0, 0.0, -3330106.931934881, 28.987639906807228, 0.0, 0.0, 22826.420749269666, -268.03701464855311, 0.0, 0.0, 3576.584063907846, 265.67760996062378, 0.0, 0.0, -5462.4287352134843, 716.625342133549, 0.0, 0.0, 1521.4546293362137, 1619.8448721398474, 5968331.0242768722, 0.0, 0.0, 0.0, -5156891.1599254739, 56.578258598284997, 0.0, 0.0, 1284381.3707011165, 295.17858661711142, 0.0, 0.0, 5600839.505133572, -466.2266968907515, 0.0, 0.0, -2448.1546653720252, 370.96260733076548, 0.0, 0.0, -1337.75126206598, 240.67607007039439, 0.0, 0.0, -4187.4156024887161, 1174.0683516802665, 0.0, 0.0, -3251.2277427859794, 1091.2265901725689, 4908531.0936356327, 0.0, 0.0, 0.0, -2976121.4542161366, -40.370411157897486, 0.0, 0.0, -782177.89463619236, -237.70538429693568, 0.0, 0.0, 1488443.5696334438, 536.84010544171656, 0.0, 0.0, -378573.45006713655, 238.45791846075903, 0.0, 0.0, -304.0535891308773, 9.3773757644734541, 0.0, 0.0, 1824.9508893474156, -620.70853326596068, 0.0, 0.0, 653.85443272571467, -283.3612483067061, 0.0, 0.0, -1802.9742313964164, 273.86285311324133, 0.0, 0.0, 275.86347266242797, -436.52991614526763, -217477.59854517016, 0.0, 0.0, 0.0, 44507.373441772914, -299.48648682724689, 0.0, 0.0, -621375.59118344425, 37.53276300626716, 0.0, 0.0, 546764.66097393597, -555.61364840266515, 0.0, 0.0, 2295012.3143068785, -282.43206933312456, 0.0, 0.0, 511829.33046959835, -539.10198693276766, 0.0, 0.0, -3670.4087919318331, 72.032214574063318, 0.0, 0.0, 1479.7227434114548, 174.71393334297653, 0.0, 0.0, -849.21994553435638, 388.79942795853856, 0.0, 0.0, 443.20708851283689, -107.45528698967912, 0.0, 0.0, -685.06839700330704, 185.48952061132815, 0.0, 0.0, 202.6139316548763, 359.73167617614217, -1881524.945790115, 0.0, 0.0, 0.0, 1541951.9867164902, 299.92672292974083, 0.0, 0.0, -972940.39482596307, -83.843165007720231, 0.0, 0.0, 1883216.0088711039, -74.771970002958852, 0.0, 0.0, 703360.75124271866, 100.96495732148153, 0.0, 0.0, -1147309.7090038673, 153.56602202329105, 0.0, 0.0, 927397.31275416655, 47.048194208048486, 0.0, 0.0, -2188.140223446504, 86.921053455575532, 0.0, 0.0, 2517.4650858537898, -327.84709227142201, 0.0, 0.0, -430.46102736467139, -175.42686998064639, 0.0, 0.0, 291.80979845363856, 94.407214179147729, 0.0, 0.0, 455.42254073075031, -177.75025138492933, 0.0, 0.0, 506.87530083889607, 106.01946437686614, 0.0, 0.0, 1124.0413452094122, 90.597085033092398, 758.23611669873753, 0.0, 0.0, 0.0, -109883.15485288057, -196.89098833680009, 0.0, 0.0, 151861.58980999538, 66.689943031200968, 0.0, 0.0, -406495.72746608406, -219.34067019594175, 0.0, 0.0, -1196404.3466755671, -194.71003212123568, 0.0, 0.0, -1251328.355712553, -735.58261344567734, 0.0, 0.0, -108587.27048517032, 157.26264131156495, 0.0, 0.0, -216471.35275843021, 276.71145894909267, 0.0, 0.0, 1685.3120028982562, -187.12560532246854, 0.0, 0.0, -2251.0056257485926, 359.37150824582653, 0.0, 0.0, 2201.8210033437881, -203.75503967851651, 0.0, 0.0, -793.19178778520654, -21.867340564482998, 0.0, 0.0, 241.18824264203815, -91.188380695750126, 0.0, 0.0, 898.04978371417826, -131.93827189712607, 0.0, 0.0, -355.3155698903642, 23.255395714792215, 0.0, 0.0, -291.89766746952262, -34.90510044506712, 2760298.2922090245, 0.0, 0.0, 0.0, -1568559.1554634371, 44.850113588144694, 0.0, 0.0, -492036.51398169651, -21.403244482944274, 0.0, 0.0, -1346866.9744909781, 471.79630974311306, 0.0, 0.0, 1047140.1520603537, 202.42725906037387, 0.0, 0.0, 219658.9386857514, 75.299206728682705, 0.0, 0.0, -987605.90690837556, 16.427150345160523, 0.0, 0.0, -386423.45507789578, -63.215058703551541, 0.0, 0.0, 511023.84828453982, -362.32374234758652, 0.0, 0.0, 732.61697021186751, 138.30210250476506, 0.0, 0.0, -652.03402378691828, -124.30491552566821, 0.0, 0.0, 846.18598157993063, 77.364941709839798, 0.0, 0.0, -1185.8962262538398, -162.77730573760419, 0.0, 0.0, 561.08455117555377, 292.22229081024227, 0.0, 0.0, 309.93641710954984, -96.382151043900166, 0.0, 0.0, -858.692635672248, 269.72856949797978, 0.0, 0.0, -566.9905297897028, -71.129844947188644, 0.0, 0.0, 171.32390552901032, 10.112341116865156, -382447.6505241351, 0.0, 0.0, 0.0, -192308.84855002636, 133.23038228252997, 0.0, 0.0, -624199.20122560021, -101.36520204979722, 0.0, 0.0, -1248821.7066374063, -431.05499556814158, 0.0, 0.0, 1545989.8014246153, 35.695476671435898, 0.0, 0.0, -1070381.7606738035, -569.74251153505293, 0.0, 0.0, -1540426.4872217609, -197.33934946552307, 0.0, 0.0, -1373007.1784750416, 476.35227042978107, 0.0, 0.0, -554680.26177198521, 199.65297962190272, 0.0, 0.0, 275875.70942312398, 478.74968602067941, 0.0, 0.0, -1939.6458634371561, 74.18834496357799, 0.0, 0.0, 2428.3771514165551, -492.9900383212493, 0.0, 0.0, -1403.9506755538848, 96.570038829767725, 0.0, 0.0, 748.06688607623505, -321.21983677333481, 0.0, 0.0, -136.50693671541407, 152.8630926300585, 0.0, 0.0, -663.42812685761771, -189.02417144967634, 0.0, 0.0, -231.09875176765922, -199.12137960978015, 0.0, 0.0, -1068.6154241627346, -58.221818092729784, 0.0, 0.0, 374.24916350370876, -26.304464162117249, 0.0, 0.0, 154.11737161513827, 29.943110899143882, -2478327.7870924175, 0.0, 0.0, 0.0, 1545695.2134453175, 154.26242870225497, 0.0, 0.0, -246681.18977268288, 38.337079261690889, 0.0, 0.0, -275939.44498768135, 486.46033783434137, 0.0, 0.0, -372162.64583207935, 245.80302395256516, 0.0, 0.0, -705970.97478633758, -199.38602418461048, 0.0, 0.0, -735577.41858157236, -129.03866430563042, 0.0, 0.0, -908912.87776201393, -809.46752348616167, 0.0, 0.0, -1404022.3323176433, -246.64936015827348, 0.0, 0.0, 191329.44027101251, -458.52812638993032, 0.0, 0.0, -115961.8990160184, 65.556597626301524]
        ),
        'alm2': n.array(
[2149841.7406296935, 0.0, 0.0, 0.0, 1821.4415781773762, -59.066709902182488, 1419893.9035809997, 0.0, 0.0, 0.0, -753588.79607658007, 86.369429705398915, 0.0, 0.0, 1477.8750483709093, -111.09898435820898, 0.0, 0.0, -695.02620141576665, 130.68437151429544, 158269.59669949958, 0.0, 0.0, 0.0, 619150.09579849953, -6.3559430384169628, 0.0, 0.0, -22898.963148520477, 49.086819993220224, 0.0, 0.0, -673.36586077956554, -46.538413504974919, 0.0, 0.0, 1008.3295654855258, -137.46196242846173, 0.0, 0.0, -299.03105433678695, -319.96982122597984, -1143523.0909785645, 0.0, 0.0, 0.0, 980096.90783564257, -10.398375688849198, 0.0, 0.0, -233039.69523834207, -56.940690262156409, 0.0, 0.0, -1099120.4046878628, 89.343275679972791, 0.0, 0.0, 448.51453083623221, -70.482392856033812, 0.0, 0.0, 249.98600362030305, -45.452139834294279, 0.0, 0.0, 781.79871479263375, -225.16525053109535, 0.0, 0.0, 620.22534771269443, -208.19996215969758, -929773.85554526898, 0.0, 0.0, 0.0, 572761.41682222218, 8.0400025008666365, 0.0, 0.0, 159783.71756645714, 46.60771212488266, 0.0, 0.0, -291023.04892075201, -104.82492456259236, 0.0, 0.0, 74104.730349339283, -46.068439291865573, 0.0, 0.0, 59.575205790192101, -0.56509407801489386, 0.0, 0.0, -334.39445772870681, 116.72643584389517, 0.0, 0.0, -121.43330421640583, 57.165009206014567, 0.0, 0.0, 329.4334086658472, -52.456582111006306, 0.0, 0.0, -47.3952605882264, 81.729197783368832, 25607.641297362698, 0.0, 0.0, 0.0, 2942.2187638044702, 59.550325794074951, 0.0, 0.0, 108005.56966014902, -7.6128369956389221, 0.0, 0.0, -101674.15780860042, 107.0205347542299, 0.0, 0.0, -452317.44597329287, 55.074277455613185, 0.0, 0.0, -104781.49882907663, 105.01290456540194, 0.0, 0.0, 661.07248192236921, -16.015401763415962, 0.0, 0.0, -259.29015498340942, -34.318109444587975, 0.0, 0.0, 156.04882047058229, -75.638755429245961, 0.0, 0.0, -76.20193254532478, 20.116752831010519, 0.0, 0.0, 133.90008313350822, -35.086591865281207, 0.0, 0.0, -33.47214598373111, -71.363722082463099, 348147.09517630719, 0.0, 0.0, 0.0, -288360.35187213257, -58.794344498761703, 0.0, 0.0, 186258.89716305549, 16.528496735492599, 0.0, 0.0, -358876.36237769533, 15.195075557621012, 0.0, 0.0, -138599.88550429899, -19.172630625152021, 0.0, 0.0, 213008.9922189904, -30.409556372731213, 0.0, 0.0, -177566.81147618542, -9.6561363322927622, 0.0, 0.0, 400.68028300412254, -16.107550646135945, 0.0, 0.0, -461.23128872960211, 64.043169171214444, 0.0, 0.0, 77.590526586490526, 34.282466067760659, 0.0, 0.0, -53.883239678184218, -17.768963237578372, 0.0, 0.0, -83.264193383508299, 35.103669476953421, 0.0, 0.0, -90.846397615621427, -19.951706346750342, 0.0, 0.0, -215.37621658552095, -17.125502653377008, 16666.122709825442, 0.0, 0.0, 0.0, 10452.678087860097, 39.508935689655466, 0.0, 0.0, -29581.392704522706, -13.360185151109638, 0.0, 0.0, 78726.519730675282, 42.099183259932751, 0.0, 0.0, 231778.02947671694, 38.886815193500112, 0.0, 0.0, 235840.77350343473, 143.52084940662147, 0.0, 0.0, 23416.249959224599, -30.039172232568593, 0.0, 0.0, 42132.51446181794, -56.029693359879211, 0.0, 0.0, -306.72860655289224, 35.974883956801072, 0.0, 0.0, 413.94335224520478, -68.652267425618078, 0.0, 0.0, -403.29042669670724, 38.306006531577133, 0.0, 0.0, 145.21133352051007, 2.674011131961513, 0.0, 0.0, -43.061641665014996, 18.338028764807156, 0.0, 0.0, -161.87929017740342, 25.024512477361906, 0.0, 0.0, 64.438510237088565, -4.9922462550895927, 0.0, 0.0, 53.517204710057015, 5.4629381564871489, -526249.73902376078, 0.0, 0.0, 0.0, 299297.14517453278, -8.4953415365775946, 0.0, 0.0, 97471.857610506646, 4.7756549837256861, 0.0, 0.0, 259510.39758511353, -90.881577149921085, 0.0, 0.0, -199328.59501984422, -39.06712722165944, 0.0, 0.0, -39038.284470715669, -16.285446487343894, 0.0, 0.0, 192812.93197835219, -3.4450388777273169, 0.0, 0.0, 76625.529947549046, 13.079882530169707, 0.0, 0.0, -99696.819671289923, 70.110279789197548, 0.0, 0.0, -134.70385667325473, -26.559226114053249, 0.0, 0.0, 115.92700948235075, 24.493848013866007, 0.0, 0.0, -148.16871534275043, -14.760437783811518, 0.0, 0.0, 206.39392290031384, 30.327409666793326, 0.0, 0.0, -96.260978038272029, -55.052281264220937, 0.0, 0.0, -61.680976503587054, 17.608666587867322, 0.0, 0.0, 157.81246363338275, -51.561857560654097, 0.0, 0.0, 101.09496601769634, 14.226861220551479, 0.0, 0.0, -35.812134582047477, -2.5023704013824375, 60258.71138700124, 0.0, 0.0, 0.0, 44389.197960012112, -25.405774604859349, 0.0, 0.0, 118151.54879074295, 19.120100997459126, 0.0, 0.0, 240095.21773768248, 83.761427650466018, 0.0, 0.0, -298398.04890687595, -6.7669059690610212, 0.0, 0.0, 210489.45359173793, 110.94575683228179, 0.0, 0.0, 298053.02042392752, 40.175493503573378, 0.0, 0.0, 270538.88404434675, -94.475639161735529, 0.0, 0.0, 108442.87218065951, -38.88723456669431, 0.0, 0.0, -53056.631988481371, -91.525200576044156, 0.0, 0.0, 349.71248690743431, -15.300132585462071, 0.0, 0.0, -435.97657021348482, 95.237608822687633, 0.0, 0.0, 255.57845991729826, -18.859404140733574, 0.0, 0.0, -137.14491845487706, 60.666415522280872, 0.0, 0.0, 25.027171439657984, -26.936344348964262, 0.0, 0.0, 123.93127834330485, 34.911983704106937, 0.0, 0.0, 36.66294257504876, 37.707931814952666, 0.0, 0.0, 194.62352497834402, 11.670281366263699, 0.0, 0.0, -69.095274730842632, 4.5478299719938979, 0.0, 0.0, -29.585318867700071, -6.1871092281154301, 477978.94435272063, 0.0, 0.0, 0.0, -297769.64415456908, -30.390817044811168, 0.0, 0.0, 45026.663049990122, -6.806573509700816, 0.0, 0.0, 50410.529147154572, -94.429980447202539, 0.0, 0.0, 72627.345813670152, -48.179452572346179, 0.0, 0.0, 133844.29550183236, 38.489501730149719, 0.0, 0.0, 142345.03445883316, 25.543632747264606, 0.0, 0.0, 176743.17473518907, 157.94457457857945, 0.0, 0.0, 273288.3335257764, 48.392943529701881, 0.0, 0.0, -37022.881090226118, 88.064824303749148, 0.0, 0.0, 22552.53347965264, -12.795709363977792]
        ),
        'alm1': n.array(
[-161951.67764840575, 0.0, 0.0, 0.0, -128.08061413667926, 4.6034171353158282, -105953.94274359036, 0.0, 0.0, 0.0, 56745.497376565705, -6.6096627800085228, 0.0, 0.0, -108.67998790421426, 7.8240965928110606, 0.0, 0.0, 52.700381361619264, -9.7750448028195489, -13422.390408668512, 0.0, 0.0, 0.0, -45575.435249492395, 0.52553380229245839, 0.0, 0.0, 2784.0430363972728, -3.5699618152223449, 0.0, 0.0, 50.108419735944999, 3.2852040126657807, 0.0, 0.0, -73.970123344524183, 10.369731646394772, 0.0, 0.0, 22.893688783826573, 24.654949026974641, 86142.069166679285, 0.0, 0.0, 0.0, -73399.463426532689, 0.75743843762401764, 0.0, 0.0, 16819.229589860835, 4.3144820912816746, 0.0, 0.0, 84259.339980799763, -6.7337626563086186, 0.0, 0.0, -32.697239717632705, 5.2799838951217133, 0.0, 0.0, -18.49151153606477, 3.3824448081322345, 0.0, 0.0, -57.817558034855288, 16.98024434565361, 0.0, 0.0, -46.543033644645668, 15.636333810535923, 69454.775245438577, 0.0, 0.0, 0.0, -43291.057710185974, -0.62473008065438862, 0.0, 0.0, -12586.288445559618, -3.5726042597881991, 0.0, 0.0, 22252.434392473704, 8.0084072277942031, 0.0, 0.0, -5674.0574816438912, 3.4945159110994886, 0.0, 0.0, -4.5633009348470965, -0.028499557099388548, 0.0, 0.0, 24.389970435399587, -8.6770609593373624, 0.0, 0.0, 8.9433317678949056, -4.4647049497293363, 0.0, 0.0, -23.974610681233884, 3.9505172421897994, 0.0, 0.0, 3.2890701950389691, -6.0488740854951351, -1011.3060506718718, 0.0, 0.0, 0.0, -864.84167027565866, -4.6075345244419239, 0.0, 0.0, -7520.9916734672188, 0.59725722824575156, 0.0, 0.0, 7480.8718977080625, -8.092435848449659, 0.0, 0.0, 34806.266702204935, -4.2028743160863948, 0.0, 0.0, 8273.7139525359962, -8.0072933580727508, 0.0, 0.0, -47.582613900340164, 1.3285194536212257, 0.0, 0.0, 18.262935396999683, 2.6290094622714868, 0.0, 0.0, -11.407902245460059, 5.766484643114457, 0.0, 0.0, 5.277548312942824, -1.4886696930517374, 0.0, 0.0, -10.22735227473868, 2.6184150755780431, 0.0, 0.0, 2.2623462140075028, 5.5152136914057408, -25553.993360813081, 0.0, 0.0, 0.0, 21333.26355112196, 4.5006287674412961, 0.0, 0.0, -14036.909703550165, -1.2763775897624217, 0.0, 0.0, 26923.317482528339, -1.190045763248784, 0.0, 0.0, 10666.995164150976, 1.4384291940990186, 0.0, 0.0, -15676.17920891096, 2.3489132760654945, 0.0, 0.0, 13371.979316974379, 0.76342615433374583, 0.0, 0.0, -29.218741695219904, 1.1825477018949573, 0.0, 0.0, 33.639516755875512, -4.8928827153221564, 0.0, 0.0, -5.5871933758124657, -2.6188155049421571, 0.0, 0.0, 3.957129114363803, 1.3174194475408827, 0.0, 0.0, 6.0629488294232585, -2.7051112511782018, 0.0, 0.0, 6.5111403731596758, 1.4812012671526913, 0.0, 0.0, 16.235937942959492, 1.2762800310428291, -2212.2448490888182, 0.0, 0.0, 0.0, -176.45013262554309, -3.0773773194441238, 0.0, 0.0, 2255.563057204462, 1.038095852859702, 0.0, 0.0, -5967.0828569826908, -3.176520914854164, 0.0, 0.0, -17614.216024098121, -3.0194596288542561, 0.0, 0.0, -17557.215942722669, -10.955794334878666, 0.0, 0.0, -1912.2513324580837, 2.2577747488657942, 0.0, 0.0, -3213.4439312921368, 4.38859480509488, 0.0, 0.0, 22.264529246718546, -2.7164786199665722, 0.0, 0.0, -30.280738982093037, 5.1658315039064808, 0.0, 0.0, 29.411058874050049, -2.8464731454918257, 0.0, 0.0, -10.593537085848626, -0.11903842683947398, 0.0, 0.0, 3.0825936144485699, -1.4280453438706666, 0.0, 0.0, 11.653246407414859, -1.8724704071054026, 0.0, 0.0, -4.6618073896592778, 0.40665219441510531, 0.0, 0.0, -3.8996272821596314, -0.34185045697213745, 39518.652376879632, 0.0, 0.0, 0.0, -22488.199241922528, 0.63136311908798792, 0.0, 0.0, -7530.3363890039427, -0.39809341170368162, 0.0, 0.0, -19628.157920831927, 6.8743539393709252, 0.0, 0.0, 14938.919992558431, 2.958955984667488, 0.0, 0.0, 2775.2556192314978, 1.3309242477200756, 0.0, 0.0, -14741.260159815074, 0.27692407917751105, 0.0, 0.0, -5923.034569629026, -1.0406339032184302, 0.0, 0.0, 7613.0197333450333, -5.3225898766440913, 0.0, 0.0, 9.8509476301688483, 2.0054536769649305, 0.0, 0.0, -8.2603487332168299, -1.8844971368409247, 0.0, 0.0, 10.426031369634025, 1.1084460387430564, 0.0, 0.0, -14.449368207204445, -2.2414431721392667, 0.0, 0.0, 6.6592828885173789, 4.0997503872394088, 0.0, 0.0, 4.7751380329248123, -1.2812448447164106, 0.0, 0.0, -11.535621402646923, 3.879875485281405, 0.0, 0.0, -7.2168804704406719, -1.1060572498758501, 0.0, 0.0, 2.8690019715051931, 0.21942991403216042, -3799.6744616407182, 0.0, 0.0, 0.0, -3777.8946765414585, 1.9048267205372249, 0.0, 0.0, -8820.1683780796538, -1.4247311863451848, 0.0, 0.0, -18145.823450212476, -6.3746568854258845, 0.0, 0.0, 22617.268840521858, 0.50040380562194098, 0.0, 0.0, -16169.626879416513, -8.4557486779238573, 0.0, 0.0, -22632.018283333782, -3.1588711733714474, 0.0, 0.0, -20810.645551482437, 7.2974497584696705, 0.0, 0.0, -8292.4097507249899, 2.9676068729049607, 0.0, 0.0, 4009.0694096686466, 6.8861618799958029, 0.0, 0.0, -25.197516553729219, 1.2132943590586169, 0.0, 0.0, 31.302415384083833, -7.2203987505880658, 0.0, 0.0, -18.547889950995032, 1.4413130253256319, 0.0, 0.0, 10.008135714035728, -4.5262230097995504, 0.0, 0.0, -1.8255710154343312, 1.9046952733666336, 0.0, 0.0, -9.1690290599097466, -2.5608275938876792, 0.0, 0.0, -2.3612545415944055, -2.815084132495409, 0.0, 0.0, -14.12945458043805, -0.90806168326054792, 0.0, 0.0, 5.0665773515199737, -0.31504058580083777, 0.0, 0.0, 2.2335855473482189, 0.49232292678223083, -36198.539448887896, 0.0, 0.0, 0.0, 22531.655345977397, 2.3345441583455768, 0.0, 0.0, -3260.2070129885074, 0.48072499070678953, 0.0, 0.0, -3664.324286987588, 7.1842949810564933, 0.0, 0.0, -5541.5982960513129, 3.6875600668485902, 0.0, 0.0, -10015.064666658274, -2.9142567641217609, 0.0, 0.0, -10802.381776666827, -1.9686707017403058, 0.0, 0.0, -13463.594420002923, -12.06090348652452, 0.0, 0.0, -20833.8197831744, -3.7098171680581533, 0.0, 0.0, 2812.1111979745897, -6.6471606329774673, 0.0, 0.0, -1718.8400769101377, 0.97788551336293905]
        ),
        'alm0': n.array(
[4565.8155801999528, 0.0, 0.0, 0.0, 3.3895055677125674, -0.13410492038485941, 2963.3270160476477, 0.0, 0.0, 0.0, -1600.2773636066136, 0.18918655067873286, 0.0, 0.0, 3.0024441510835524, -0.20680956018406457, 0.0, 0.0, -1.4955990846615737, 0.27383793223601971, 419.86256950205859, 0.0, 0.0, 0.0, 1258.0393341796103, -0.01607902877147754, 0.0, 0.0, -106.46990465783742, 0.097390147024199514, 0.0, 0.0, -1.3988297226413478, -0.087508396172847738, 0.0, 0.0, 2.0388751641266953, -0.2930592080193275, 0.0, 0.0, -0.65433140649783139, -0.71014225037846679, -2430.1034808280488, 0.0, 0.0, 0.0, 2059.8988284013221, -0.020671325314837913, 0.0, 0.0, -455.30669164011255, -0.12244658291112472, 0.0, 0.0, -2415.1103992110725, 0.19012533615855515, 0.0, 0.0, 0.89563525954234691, -0.14827500483611489, 0.0, 0.0, 0.51320381939010395, -0.09427451331489807, 0.0, 0.0, 1.6049339453585558, -0.47965999019598343, 0.0, 0.0, 1.3078320146977283, -0.43993588339997636, -1944.5446485299442, 0.0, 0.0, 0.0, 1225.1175906604667, 0.018161988305002871, 0.0, 0.0, 369.21690962785044, 0.10244223015258264, 0.0, 0.0, -636.37785912259187, -0.22886488712621267, 0.0, 0.0, 162.54540323795305, -0.09927896458672042, 0.0, 0.0, 0.13072943014470897, 0.0026707193405463613, 0.0, 0.0, -0.66858692332343517, 0.24193516458221853, 0.0, 0.0, -0.24724418809574003, 0.13002008545533389, 0.0, 0.0, 0.65581919733290639, -0.11142102658555275, 0.0, 0.0, -0.086061896078315395, 0.16783014191313375, 4.3450688896663543, 0.0, 0.0, 0.0, 41.103144180810887, 0.13313108272556978, 0.0, 0.0, 196.33257769378673, -0.017465191751861304, 0.0, 0.0, -206.30718257381386, 0.22907310847728871, 0.0, 0.0, -1001.5737568914351, 0.11998221062516179, 0.0, 0.0, -243.37155227541945, 0.22840625281815791, 0.0, 0.0, 1.288271108416698, -0.040598393256829131, 0.0, 0.0, -0.48430091002026682, -0.075222848347841681, 0.0, 0.0, 0.31340013642194187, -0.16454091292196354, 0.0, 0.0, -0.13747609484163115, 0.041284256798018275, 0.0, 0.0, 0.29200692502719788, -0.073239987184691047, 0.0, 0.0, -0.058048179035880582, -0.15926946224151461, 703.94858517524858, 0.0, 0.0, 0.0, -591.93169006001438, -0.12876317962982151, 0.0, 0.0, 396.47794243075759, 0.036944538826148232, 0.0, 0.0, -756.63303687755945, 0.034676723577515382, 0.0, 0.0, -307.05785088342526, -0.040506165178996141, 0.0, 0.0, 432.94583396668503, -0.067841744893327977, 0.0, 0.0, -377.19820637350057, -0.022473752108183621, 0.0, 0.0, 0.80102076584674919, -0.03255914169963027, 0.0, 0.0, -0.92214636343749823, 0.13981234957117283, 0.0, 0.0, 0.15131524274181721, 0.074794283918696913, 0.0, 0.0, -0.10925034622662094, -0.036560242298864086, 0.0, 0.0, -0.16594689806031532, 0.077946168782146108, 0.0, 0.0, -0.17550436458035704, -0.041188563837912716, 0.0, 0.0, -0.45859679333462594, -0.035632983762453073, 87.544763265247653, 0.0, 0.0, 0.0, -11.249340633589199, 0.089464709519728056, 0.0, 0.0, -64.341226111153048, -0.030080330792544949, 0.0, 0.0, 169.04773630318763, 0.089772343548372102, 0.0, 0.0, 501.19135717731791, 0.087571568762549748, 0.0, 0.0, 490.15230968986981, 0.31281478006136515, 0.0, 0.0, 57.829596484387785, -0.063561329667268102, 0.0, 0.0, 91.749576611071262, -0.12813743197917898, 0.0, 0.0, -0.60777358916886348, 0.076804439332218671, 0.0, 0.0, 0.83248582051502384, -0.14570638580226686, 0.0, 0.0, -0.80625004394386379, 0.07933150119623586, 0.0, 0.0, 0.29066036129730038, 0.0012711808079332349, 0.0, 0.0, -0.083126721532419651, 0.04146194754364959, 0.0, 0.0, -0.31539013490534479, 0.052531947067325224, 0.0, 0.0, 0.12679679479095773, -0.012279274482558429, 0.0, 0.0, 0.10666753051651173, 0.0078159181269903365, -1112.2170691049962, 0.0, 0.0, 0.0, 633.20349424154233, -0.017517915547616822, 0.0, 0.0, 217.50930332450761, 0.012245610974225742, 0.0, 0.0, 555.75301607776601, -0.19469939895060248, 0.0, 0.0, -419.38735978501506, -0.083887164401298911, 0.0, 0.0, -74.128419890224606, -0.040231107910528974, 0.0, 0.0, 421.84498919119238, -0.0082742040633023359, 0.0, 0.0, 171.14637571388599, 0.030819197467616136, 0.0, 0.0, -217.50508108478365, 0.15128515354088809, 0.0, 0.0, -0.27071083362715997, -0.056723429864605053, 0.0, 0.0, 0.22150794518428207, 0.054218070056894871, 0.0, 0.0, -0.27612368748534921, -0.03118241784236624, 0.0, 0.0, 0.38070254994347302, 0.062219769164965154, 0.0, 0.0, -0.17336130106127792, -0.11454016648199268, 0.0, 0.0, -0.13804217688459755, 0.035033313331800597, 0.0, 0.0, 0.31683582698553298, -0.10941117449369774, 0.0, 0.0, 0.19380300809025616, 0.032110461785911371, 0.0, 0.0, -0.085469264902350892, -0.006974388801320161, 87.783069186074201, 0.0, 0.0, 0.0, 118.09874795676578, -0.053453289360717818, 0.0, 0.0, 246.76506973766467, 0.039828717764335768, 0.0, 0.0, 513.77160755230682, 0.18149689210683279, 0.0, 0.0, -642.04855635407966, -0.013751779019979388, 0.0, 0.0, 464.53970693197755, 0.2410637389152093, 0.0, 0.0, 643.5311159473722, 0.092562835589626899, 0.0, 0.0, 598.56526892624402, -0.21056680243283457, 0.0, 0.0, 237.19295642923331, -0.08477406810896404, 0.0, 0.0, -113.44868474178926, -0.19412014629710406, 0.0, 0.0, 0.68299762613112514, -0.035809071420310708, 0.0, 0.0, -0.84547396193375968, 0.20494342756610162, 0.0, 0.0, 0.50605676839525704, -0.041213074366456159, 0.0, 0.0, -0.27450219799525122, 0.1266735306082748, 0.0, 0.0, 0.050033775944716037, -0.050649294018823204, 0.0, 0.0, 0.25460702007980607, 0.070524324462195198, 0.0, 0.0, 0.056806734459517366, 0.078740097442065754, 0.0, 0.0, 0.3856362855352497, 0.02637888060806463, 0.0, 0.0, -0.13952329136384584, 0.0081822641771101476, 0.0, 0.0, -0.063178987240099752, -0.01459472120245746, 1026.5966251165921, 0.0, 0.0, 0.0, -638.50254615714266, -0.066994744142531287, 0.0, 0.0, 88.42212755607089, -0.012686187042416591, 0.0, 0.0, 100.03045665696921, -0.20456814885779531, 0.0, 0.0, 158.08849595183995, -0.10548006177290432, 0.0, 0.0, 281.07030406646544, 0.082570348960279052, 0.0, 0.0, 306.8276237305476, 0.056673624105404302, 0.0, 0.0, 383.80688083746514, 0.344561154621084, 0.0, 0.0, 594.32868029211716, 0.10634906516939167, 0.0, 0.0, -80.001412761622717, 0.18790064827565012, 0.0, 0.0, 49.03681162224224, -0.027969438088454798]
        ),
    }
}

#def get_aa(freqs):
#    '''Return the AntennaArray to be used for simulation.'''
#    location = prms['loc']
#    antennas = []
#    nants = len(prms['antpos'])
#    assert(len(prms['delays']) == nants and len(prms['amps']) == nants \
#        and len(prms['bp_r']) == nants and len(prms['bp_i']) == nants)
#    for i in range(len(prms['antpos'])):
#        beam = prms['beam'](freqs, nside=128, lmax=20, mmax=20, deg=7)
#        try: beam.set_params(prms['bm_prms'])
#        except(AttributeError): pass
#        pos = prms['antpos'][i]
#        dly = prms['delays'][i]
#        amp = prms['amps'][i]
#        bp_r = prms['bp_r'][i]
#        bp_i = prms['bp_i'][i]
#        off = prms['offsets'][i]
#        antennas.append(
#            a.fit.Antenna(pos[0],pos[1],pos[2], beam, phsoff=[dly,off],
#                amp=amp, bp_r=bp_r, bp_i=bp_i)
#        )
#    #aa = a.fit.AntennaArray(prms['loc'], antennas)
#    aa = AntennaArray(prms['loc'], antennas)
#    return aa
def get_aa(freqs):
    '''Return the AntennaArray to be used for simulation.'''
    location = prms['loc']
    antennas = []
    nants = len(prms['antpos'])
    assert(len(prms['delays']) == nants and len(prms['amps']) == nants \
        and len(prms['bp_r']) == nants and len(prms['bp_i']) == nants)
   # for i in range(len(prms['antpos'])):
#        beam = prms['beam'](freqs, nside=128, lmax=20, mmax=20, deg=7)
#        try: beam.set_params(prms['bm_prms'])
#        except(AttributeError): pass
#        pos = prms['antpos'][i]
#        dly = prms['delays'][i]
#        amp = prms['amps'][i]
#        bp_r = prms['bp_r'][i]
#        bp_i = prms['bp_i'][i]
#        off = prms['offsets'][i]
#        antennas.append(
#            capodb.Antenna(pos[0],pos[1],pos[2], beam, phsoff=[dly,off],
#                amp=amp, bp_r=bp_r, bp_i=bp_i,id=i)
#        )
#    #aa = a.fit.AntennaArray(prms['loc'], antennas)
#    aa = capodb.AntennaArray(prms['loc'], antennas)
    beam = prms['beam'](freqs, nside=128, lmax=20, mmax=20, deg=7)
    aa = capodb.AntennaArray(prms['loc'],[],filename='pgb16_gps.db',beam=beam)
    return aa

src_prms = {
        'cyg': {},
        'cas': {
            'jys':8300, 'index':-0.43, 'a1':.00104, 'a2':.00089, 'th':0,
        },
        'Sun': {
            'jys': 33234, 'index':2.80, 'a1':.00540, 'a2':.00490, 'th':0,
        },
        'vir': {
            'jys': 985, 'index':-1.01,
            'ddec':-0.00026, 'dra':-0.00021,
        },
        'crab': {
            'jys': 1044, 'index':-0.14
        },
        'J0043+520': { 'jys':10**2.14445, 'index': [-2.155937], }, 
        'J0138+331': { 'jys':10**2.62940, 'index': [-3.008918], },
        'J0320+413': { 'jys':10**2.78704, 'index': [-3.385801], },
        'J0418+380': { 'jys':10**3.07882, 'index': [-4.248247], },
        'J0437+294': { 'jys':10**2.89789, 'index': [-2.381867], },
        'J0505+381': { 'jys':10**2.56211, 'index': [-2.531004], },
        'J0543+495': { 'jys':10**2.25664, 'index': [-2.044230], },
        'J0814+481': { 'jys':10**2.33850, 'index': [-2.227837], },
        'J1411+521': { 'jys':10**2.13885, 'index': [-1.170424], },
        'J1830+484': { 'jys':10**2.02917, 'index': [-0.854137], },
        'J2014+233': { 'jys':10**2.08516, 'index': [-0.480923], },
        'J2124+250': { 'jys':10**2.01829, 'index': [-0.805656], },
        'J2156+380': { 'jys':10**1.79585, 'index': [-0.403395], },

        'J0030+636':{ 'jys':10**1.463708, 'index': [-0.468753], },
        'J0109+132':{ 'jys':10**2.107620, 'index': [-1.134058], },
        'J0136+206':{ 'jys':10**2.563445, 'index': [-3.613798], },
        'J0918-121':{ 'jys':10**3.151499, 'index': [-2.767146], },
        'J0921+454':{ 'jys':10**2.317098, 'index': [-2.627839], },
        'J1002+285':{ 'jys':10**2.246108, 'index': [-2.636674], },
        'J1229+020':{ 'jys':10**1.820748, 'index': [-0.376488], },
        'J1419+063':{ 'jys':10**1.920056, 'index': [-0.635954], },
        'J1505+260':{ 'jys':10**2.137927, 'index': [-1.276840], }, 
        'J1629+393':{ 'jys':10**2.010967, 'index': [-0.938099], },
        'J1651+046':{ 'jys':10**2.608101, 'index': [-0.040622], },
        'J1721-006':{ 'jys':10**2.417463, 'index': [-0.136423], },
        'J2014+233':{ 'jys':10**2.085166, 'index': [-0.480923], },
        'J2124+250':{ 'jys':10**2.018295, 'index': [-0.805656], },
        'J2246+394':{ 'jys':10**2.212076, 'index': [-1.539116], },
}

class _PeggedBody:
    def __init__(self):
        self._pegs = {}
        self._orig_ra = None
        self._orig_dec = None
    def peg(self, times, strs, ras=None, decs=None):
        if ras is None: ras = [0] * len(times)
        if decs is None: decs = [0] * len(times)
        for t,s,r,d in zip(times,strs,ras,decs): self._pegs[t] = (s,r,d)
    def fix_str(self, observer):
        t = str(observer.get_jultime())
        if self._pegs.has_key(t): self.janskies *= self._pegs[t][0]
    def fix_pos(self, observer):
        t = str(observer.get_jultime())
        if self._pegs.has_key(t):
            if self._orig_ra is None:
                self._orig_ra = self._ra
                self._orig_dec = self._dec
            self._ra = self._orig_ra + self._pegs[t][1]
            self._dec = self._orig_dec + self._pegs[t][2]
        elif not self._orig_ra is None:
            self._ra = self._orig_ra
            self._dec = self._orig_dec

class RadioFixedBody(a.fit.RadioFixedBody, _PeggedBody):
    def __init__(self, *args, **kwargs):
        a.fit.RadioFixedBody.__init__(self, *args, **kwargs)
        _PeggedBody.__init__(self)
    def compute(self, observer):
        _PeggedBody.fix_pos(self, observer)
        a.fit.RadioFixedBody.compute(self, observer)
        _PeggedBody.fix_str(self, observer)

class RadioSpecial(a.fit.RadioSpecial, _PeggedBody):
    def __init__(self, *args, **kwargs):
        a.fit.RadioSpecial.__init__(self, *args, **kwargs)
        _PeggedBody.__init__(self)
    def compute(self, observer):
        _PeggedBody.fix_pos(self, observer)
        a.fit.RadioSpecial.compute(self, observer)
        _PeggedBody.fix_str(self, observer)
        
pegged_srcs = {
    #'cyg': glob.glob('24*.cyg'),
    #'cas': glob.glob('24*.cas'),
    #'vir': glob.glob('24*.vir'),
    #'crab': glob.glob('24*.crab'),
    #'Sun': glob.glob('24*.Sun'),
    # 'cyg': 'peg_cyg5.txt',
    # 'cas': 'peg_cas4.txt',
}

def get_catalog(srcs=None, cutoff=None):
    '''Return a catalog containing the listed sources.'''
    custom_srcs = ['cygx1', 'cygx2', 'cygx3']
    if srcs is None: fsrcs = None
    else: fsrcs = [s for s in srcs if not s in custom_srcs]
    cat = a.src.get_catalog(srcs=fsrcs,
        cutoff=cutoff, fixedbody=RadioFixedBody, special=RadioSpecial)
    if srcs != None:
        for src in [s for s in srcs if s in custom_srcs]:
            cat[src] = RadioFixedBody(0., 0., janskies=0., mfreq=.15, name=src)
    cat.set_params(src_prms)
    for src in cat:
        if src in pegged_srcs:
            filename = pegged_srcs[src]
            dat = [L.split() for L in open(filename).readlines()]
            times = [L[0] for L in dat]
            strs = [float(L[1]) for L in dat]
            ras = [float(L[2]) for L in dat]
            decs = [float(L[3]) for L in dat]
            cat[src].peg(times, strs, ras, decs)
            #cat[src].peg(times, strs)
    return cat

